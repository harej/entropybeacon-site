<link rel="stylesheet" href="bootstrap.min.css">
<link rel="stylesheet" href="style.css">
<meta charset="utf-8">

<title>Skynet Entropy Beacon</title>

<div style="margin:0 auto; max-width:1000px; padding-bottom:2em;">
	<h2 class="green">Skynet Entropy Beacon</h2>
	<p>The Skynet Entropy Beacon provides securely generated randomness, produced by the beacon of your choice, delivered through the decentralized content network Skynet.</p>
	<p>Lightweight beacons that anyone can run post random data on Skynet approximately once every 30 seconds, and this randomness can be used if you do not trust your user or device to provide genuinely random data. Each random data beacon is identified by its public key, and this public key can be used to verify the signature associated with the random data, so you can be sure that the data comes from the source it claims to come from.</p>
	<p>The beacons also upload a timestamp at approximately the same time they upload the random data. This is meant to give an idea as to how fresh the data is. Entropy Beacon is not designed to be used as a timestamping service.</p>
	<p>Want to run your own beacon? The <a href="https://github.com/harej/entropybeacon">GitHub repository</a> includes instructions for deploying a beacon and getting it listed on this page. While the list on this page is curated in a centralized repository, you can also <a href="https://github.com/harej/entropybeacon-site">deploy your own beacon list</a>.</p>
</div>

<table id="contentTable" style="padding-top:5rem; margin:1rem; width:98%">
	<tbody>
		<tr>
			<th>Label</th>
			<th>Public Key</th>
			<th>Random Data</th>
			<th>Timestamp</th>
		</tr>
	</tbody>
</table>

<script src="https://sky-id.hns.siasky.net/skyid.js"></script>
<script>

	var pubkeys = [
		'9459eef0e0992c193c162af7a8adc3c598e91554b93c75ebd274f73d5781a576',
		'95af36ea6972c04c3ad6735fb014b80958b1e2ba4a68e2c1369b9a093cc801c4',
		'1ff9cba485a67a308aa2fe9cd4b3734edda27198be9a05374d2d0f83dc16127f',
		'1ce1a70cac2df5157f3af2934a4348c9080757bbd07c5e18589b6f201ef09aac'
	];

	var skyid = new SkyID('app', null);
	var sky = skyid.skynetClient;
	var table = document.getElementById('contentTable');

	async function getData(pubkey, key) {
		result = await sky.registry.getEntry(pubkey, 'entropybeacon:' + key);
		return [result.entry.data, pubkey];
	}

	function createCell(id, value) {
		var inputTag = document.createElement('input');
		inputTag.setAttribute('style', 'width:90%');
		inputTag.setAttribute('type', 'text');
		inputTag.setAttribute('readonly', '');
		inputTag.setAttribute('value', value);
		inputTag.setAttribute('id', id);
		return inputTag;
	}

	var labelTextboxes = [];
	var pubkeyTextboxes = [];
	var randomnessTextboxes = [];
	var timestampTextboxes = [];

	for (var i = 0; i < pubkeys.length; i++) {
		var pubkey = pubkeys[i];
		var row = table.insertRow(i+1);
		var labelCell = row.insertCell(0);
		var pubkeyCell = row.insertCell(1);
		var randomnessCell = row.insertCell(2);
		var timestampCell = row.insertCell(3);

		pubkeyTextboxes[pubkey] = createCell('pubkey-'+pubkey, pubkeys[i]);
		pubkeyCell.append(pubkeyTextboxes[pubkey]);

		labelTextboxes[pubkey] = createCell('label-'+pubkey, 'Loading...');
		labelCell.append(labelTextboxes[pubkey]);

		randomnessTextboxes[pubkey] = createCell('randomness-'+pubkey, 'Loading...');
		randomnessCell.append(randomnessTextboxes[pubkey]);

		timestampTextboxes[pubkey] = createCell('timestamp-'+pubkey, 'Loading...');
		timestampCell.append(timestampTextboxes[pubkey]);
	}

	for (var i = 0; i < pubkeys.length; i++) {
		var pubkey = pubkeys[i];
		getData(pubkey, 'label')
			.then((data) => {
				labelTextboxes[data[1]].setAttribute('value', data[0])
			});
		getData(pubkey, 'data')
			.then((data) => {
				randomnessTextboxes[data[1]].setAttribute('value', data[0])
			});
		getData(pubkey, 'time')
			.then((data) => {
				timestampTextboxes[data[1]].setAttribute('value', data[0])
			});
	}

</script>
